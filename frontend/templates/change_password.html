<!DOCTYPE html>
<html>
  <head>
    <title>비밀번호 변경 - ReportRadar</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" crossorigin="anonymous"/>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" crossorigin="anonymous"/>
    <link rel="stylesheet" href="{{ url_for('static', filename='auth.css') }}">
  </head>
  <body>
    <div class="container mypage-container">
      <div class="mypage-card">
        <div class="mypage-header">
          <img src="https://i.ibb.co/d5b84Xw/Untitled-design.png" alt="User Profile" class="profile-img"/>
          <h4>비밀번호 변경</h4>
        </div>
        
        <form action="{{ url_for('change_password') }}" method="POST" id="passwordForm">
          {% if error %}
          <div class="alert alert-danger" role="alert">
            {{ error }}
          </div>
          {% endif %}
          <div class="form-group">
            <label for="current_password" class="form-label">현재 비밀번호</label>
            <input type="password" class="form-control" name="current_password" required>
          </div>
          <div class="form-group">
            <label for="new_password" class="form-label">새 비밀번호</label>
            <input type="password" class="form-control" name="new_password" id="new_password" 
                   placeholder="영문 소문자, 숫자만 가능" required>
            <div class="error-message" id="passwordError">비밀번호는 영문 소문자와 숫자만 사용 가능합니다</div>
          </div>
          <div class="form-group">
            <label for="confirm_password" class="form-label">새 비밀번호 확인</label>
            <input type="password" class="form-control" name="confirm_password" id="confirm_password" required>
            <div class="error-message" id="confirmError">비밀번호가 일치하지 않습니다</div>
          </div>
          <div class="action-buttons">
            <button type="submit" class="btn btn-edit">
              <i class="fas fa-key"></i> 비밀번호 변경
            </button>
            <a href="{{ url_for('mypage') }}" class="btn btn-back">
              <i class="fas fa-arrow-left"></i> 마이페이지로 돌아가기
            </a>
          </div>
        </form>
      </div>
    </div>

    <script>
      document.getElementById('passwordForm').addEventListener('submit', function(e) {
        const newPassword = document.getElementById('new_password').value;
        const confirmPassword = document.getElementById('confirm_password').value;
        const passwordError = document.getElementById('passwordError');
        const confirmError = document.getElementById('confirmError');
        let isValid = true;

        if (!/^[a-z0-9]+$/.test(newPassword)) {
          passwordError.style.display = 'block';
          isValid = false;
        } else {
          passwordError.style.display = 'none';
        }

        if (newPassword !== confirmPassword) {
          confirmError.style.display = 'block';
          isValid = false;
        } else {
          confirmError.style.display = 'none';
        }

        if (!isValid) {
          e.preventDefault();
        }
      });
    </script>
  </body>
</html> 